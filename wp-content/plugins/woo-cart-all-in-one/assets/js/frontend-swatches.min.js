!function(t){"use strict";t.fn.viwcaio_get_variations=function(t){return new viwcaio_get_variation(this,t),this},window.viwcaio_get_variation=function(a,i){let e=this;e.wc_ajax_url=i.wc_ajax_url||"",e.form=a,e.product_id=parseInt(a.data("product_id")),e.variations=a.data("product_variations")||"",e.is_ajax=!e.variations,e.xhr=!1;let o={};a.on("viwcaio_check_variations",{viwcaio_get_variation:e},e.find_variation),a.on("change","select",{viwcaio_get_variation:e},e.onChange),a.find("select").each((function(){o[t(this).data("attribute_name")]=t(this).val()||""})),e.current_attr=o,setTimeout((function(){a.trigger("viwcaio_check_variations")}),100)},viwcaio_get_variation.prototype.onChange=function(a){let i=a.data.viwcaio_get_variation,e=i.form;e.find('input[name="variation_id"], input.variation_id').val("").trigger("change"),i.current_attr[t(this).data("attribute_name")]=t(this).val()||"",i.is_ajax||e.trigger("woocommerce_variation_select_change"),e.trigger("viwcaio_check_variations"),e.trigger("woocommerce_variation_has_changed")},viwcaio_get_variation.prototype.find_variation=function(a){let i=a.data.viwcaio_get_variation,e=null,o=!1,n=i.current_attr,r=i.form,c=i.variations;if(t.each(n,(function(t,a){if(!a)return o=!0,!1})),o)return i.update_attributes(n,c,r,i),i.show_variation(i,null,r),!1;i.is_ajax?(i.xhr&&i.xhr.abort(),c?(t.each(c,(function(t,a){if(i.check_is_equal(n,a.attributes))return e=a,!1})),e?i.show_variation(i,e,r):c.length<parseInt(r.data("variation_count")||0)?i.call_ajax(n,c,r,i):i.show_variation(i,null,r)):(c=[],i.call_ajax(n,c,r,i))):(t.each(c,(function(t,a){if(i.check_is_equal(n,a.attributes))return e=a,!1})),i.update_attributes(n,c,r,i),i.show_variation(i,e,r))},viwcaio_get_variation.prototype.update_attributes=function(a,i,e,o){if(o.is_ajax)return!1;e.find("select").each((function(e,n){let r,c=t(n),_=c.data("attribute_name")||c.attr("name"),s=c.data("show_option_none"),l=c.val()||"",d=!0,v=t("<select/>"),u=":gt(0)";if(!c.data("attribute_html")){let t=c.clone();t.find("option").removeAttr("disabled attached selected"),c.data("attribute_options",t.find("option"+u).get()),c.data("attribute_html",t.html())}v.html(c.data("attribute_html"));let h=t.extend(!0,{},a);h[_]="";let f=[];for(let t=0;t<i.length;t++){let a=i[t];o.check_is_equal(h,a.attributes)&&f.push(a)}for(let a in f){if(void 0===f[a])continue;let i=f[a].attributes;for(let e in i){if(!i.hasOwnProperty(e))continue;let o=i[e],n="";if(e===_)if(f[a].variation_is_active&&(n="enabled"),o){o=t("<div/>").html(o).text();let a=v.find("option");if(a.length)for(let i=0,e=a.length;i<e;i++){let e=t(a[i]);if(o===e.val()){e.addClass("attached "+n);break}}}else v.find("option:gt(0)").addClass("attached "+n)}}r=v.find("option.attached").length,l&&(d=!1,0!==r&&v.find("option.attached.enabled").each((function(){var a=t(this).val();if(l===a)return d=!0,!1}))),r>0&&l&&d&&"no"===s&&(v.find("option:first").remove(),u=""),v.find("option"+u+":not(.attached)").remove(),c.html(v.html()),c.find("option"+u+":not(.enabled)").prop("disabled",!0),l?d?c.val(l):c.val("").change():c.val("")})),e.trigger("woocommerce_update_variation_values")},viwcaio_get_variation.prototype.call_ajax=function(a,i,e,o){a.product_id=o.product_id,a.vicaio_nonce=viwcaio_ajax_atc_params.nonce,o.xhr=t.ajax({url:o.wc_ajax_url.toString().replace("%%endpoint%%","get_variation"),type:"POST",data:a,beforeSend:function(){e.closest(".vi-wcaio-va-cart-form-wrap").addClass("vi-wcaio-container-loading")},success:function(t){o.show_variation(o,t,e),t&&(i[i.length||0]=t),delete a.product_id,delete a.vicaio_nonce},complete:function(){e.closest(".vi-wcaio-va-cart-form-wrap").removeClass("vi-wcaio-container-loading")}})},viwcaio_get_variation.prototype.show_variation=function(t,a,i){if(a){let e=!0;a.is_purchasable&&a.is_in_stock&&a.variation_is_visible||(e=!1),e?(t.set_add_to_cart(a.variation_id,i),i.find(".vi-wcaio-product-bt-atc").removeClass("vi-wcaio-button-swatches-disable")):(t.set_add_to_cart("",i),i.find(".vi-wcaio-product-bt-atc").addClass("vi-wcaio-button-swatches-disable")),i.trigger("viwpvs_show_variation",[a,e])}else t.set_add_to_cart("",i),i.find(".vi-wcaio-product-bt-atc").addClass("vi-wcaio-button-swatches-disable"),i.trigger("viwpvs_hide_variation")},viwcaio_get_variation.prototype.set_add_to_cart=function(t,a){t=t||0,a.find(".variation_id").val(t)},viwcaio_get_variation.prototype.check_is_equal=function(t,a){let i=Object.getOwnPropertyNames(t),e=Object.getOwnPropertyNames(a);if(i.length!==e.length)return!1;for(let e=0;e<i.length;e++){let o=i[e],n=t[o],r=a[o];if(void 0!==n&&void 0!==r&&0!==n.length&&0!==r.length&&n!==r)return!1}return!0}}(jQuery);